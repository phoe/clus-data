====== Function ABORT, CONTINUE, MUFFLE-WARNING, STORE-VALUE, USE-VALUE ====== \idxref{abort}\idxref{continue}\idxref{muffle-warning}\idxref{store-value}\idxref{use-value}

====Syntax====

\DefunNoReturn abort {''&optional'' condition} **continue** //''&optional'' condition// → //**[[CL:Constant Variables:nil]]**// \DefunNoReturn muffle-warning {''&optional'' condition} **store-value {value** //\opt} condition// → //**[[CL:Constant Variables:nil]]**// **use-value {value** //\opt} condition// → //**[[CL:Constant Variables:nil]]**//

====Arguments and Values====

//value// - an //[[CL:Glossary:object]]//.

//condition// - a //[[CL:Glossary:condition]]// //[[CL:Glossary:object]]//, or **[[CL:Constant Variables:nil]]**.

====Description====

Transfers control to the most recently established //[[CL:Glossary:applicable restart]]// having the same name as the function. That is, the function **[[CL:Functions:abort]]** searches for an //[[CL:Glossary:applicable]]// \misc{abort} //[[CL:Glossary:restart]]//, the function **[[CL:Functions:continue]]** searches for an //[[CL:Glossary:applicable]]// \misc{continue} //[[CL:Glossary:restart]]//, and so on.

If no such //[[CL:Glossary:restart]]// exists, the functions **[[CL:Functions:continue]]**, **[[CL:Functions:store-value]]**, and **[[CL:Functions:use-value]]** return **[[CL:Constant Variables:nil]]**, and the functions **[[CL:Functions:abort]]** and **[[CL:Functions:muffle-warning]]** signal an error of type **[[CL:Types:control-error]]**.

When //condition// is //[[CL:Glossary:non-nil]]//, only those //[[CL:Glossary:restarts]]// are considered that are either explicitly associated with that //condition//, or not associated with any //[[CL:Glossary:condition]]//; that is, the excluded //[[CL:Glossary:restarts]]// are those that are associated with a non-empty set of //[[CL:Glossary:conditions]]// of which the given //condition// is not an //[[CL:Glossary:element]]//. If //condition// is **[[CL:Constant Variables:nil]]**, all //[[CL:Glossary:restarts]]// are considered.

====Examples====

<blockquote> ;;; Example of the ABORT retart

(defmacro abort-on-error (&body forms) `(handler-bind ((error #'abort)) ,@forms)) → ABORT-ON-ERROR (abort-on-error (+ 3 5)) → 8 (abort-on-error (error "You lose."))
▷ Returned to Lisp Top Level.

;;; Example of the CONTINUE restart

(defun real-sqrt (n) (when (minusp n) ([[CL:Macros:defparameter]] n (- n)) (cerror "Return sqrt(~D) instead." "Tried to take sqrt(-~D)." n)) (sqrt n))

(real-sqrt 4) → 2 (real-sqrt -9)
▷ Error: Tried to take sqrt(-9).
▷ To continue, type :CONTINUE followed by an option number:
▷ 1: Return sqrt(9) instead.
▷ 2: Return to Lisp Toplevel.
▷ Debug> \IN{(continue)}
▷ Return sqrt(9) instead. → 3

(handler-bind ((error #'(lambda (c) (continue)))) (real-sqrt -9)) → 3

;;; Example of the MUFFLE-WARNING restart

(defun count-down (x) (do ((counter x (1- counter))) ((= counter 0) 'done) (when (= counter 1) (warn "Almost done")) (format t "~&~D~ → COUNT-DOWN (count-down 3)
▷ 3
▷ 2
▷ Warning: Almost done
▷ 1 → DONE (defun ignore-warnings-while-counting (x) (handler-bind ((warning #'ignore-warning)) (count-down x))) → IGNORE-WARNINGS-WHILE-COUNTING (defun ignore-warning (condition) (declare (ignore condition)) (muffle-warning)) → IGNORE-WARNING (ignore-warnings-while-counting 3)
▷ 3
▷ 2
▷ 1 → DONE

;;; Example of the STORE-VALUE and USE-VALUE restarts

(defun careful-symbol-value (symbol) (check-type symbol symbol) (restart-case (if (boundp symbol) (return-from careful-symbol-value (symbol-value symbol)) (error 'unbound-variable :name symbol)) (use-value (value) :report "Specify a value to use this time." value) (store-value (value) :report "Specify a value to store and use in the future." ([[CL:Macros:setf]] (symbol-value symbol) value)))) ([[CL:Macros:defparameter]] a 1234) → 1234 (careful-symbol-value 'a) → 1234 (makunbound 'a) → A (careful-symbol-value 'a)
▷ Error: A is not bound.
▷ To continue, type :CONTINUE followed by an option number.
▷ 1: Specify a value to use this time.
▷ 2: Specify a value to store and use in the future.
▷ 3: Return to Lisp Toplevel.
▷ Debug> \IN{(use-value 12)} → 12 (careful-symbol-value 'a)
▷ Error: A is not bound.
▷ To continue, type :CONTINUE followed by an option number.
▷ 1: Specify a value to use this time.
▷ 2: Specify a value to store and use in the future.
▷ 3: Return to Lisp Toplevel.
▷ Debug> \IN{(store-value 24)} → 24 (careful-symbol-value 'a) → 24

;;; Example of the USE-VALUE restart

(defun add-symbols-with-default (default &rest symbols) (handler-bind ((sys:unbound-symbol #'(lambda (c) (declare (ignore c)) (use-value default)))) (apply #'+ (mapcar #'careful-symbol-value symbols)))) → ADD-SYMBOLS-WITH-DEFAULT ([[CL:Macros:defparameter]] x 1 y 2) → 2 (add-symbols-with-default 3 'x 'y 'z) → 6

</blockquote>

====Side Effects====

A transfer of control may occur if an appropriate //[[CL:Glossary:restart]]// is available, or (in the case of the function **[[CL:Functions:abort]]** or the function **[[CL:Functions:muffle-warning]]**) execution may be stopped.

====Affected By====

Each of these functions can be affected by the presence of a //[[CL:Glossary:restart]]// having the same name.

====Exceptional Situations====

If an appropriate \misc{abort} //[[CL:Glossary:restart]]// is not available for the function **[[CL:Functions:abort]]**, or an appropriate \misc{muffle-warning} //[[CL:Glossary:restart]]// is not available for the function **[[CL:Functions:muffle-warning]]**, an error of type **[[CL:Types:control-error]]** is signaled.

====See Also====

**[[CL:Functions:invoke-restart]]**, {\secref\Restarts}, {\secref\InterfacesToRestarts}, **[[CL:Macros:assert]]**, **[[CL:Macros:ccase]]**, **[[CL:Functions:cerror]]**, **[[CL:Macros:check-type]]**, **[[CL:Macros:ctypecase]]**, **[[CL:Functions:use-value]]**, **[[CL:Functions:warn]]**

====Notes====

<blockquote> (abort condition) ≡ (invoke-restart 'abort) (muffle-warning) ≡ (invoke-restart 'muffle-warning) (continue) ≡ (let ((r (find-restart 'continue))) (if r (invoke-restart r))) (use-value //x//) ≡ (let ((r (find-restart 'use-value))) (if r (invoke-restart r //x//))) (store-value x) ≡ (let ((r (find-restart 'store-value))) (if r (invoke-restart r //x//))) </blockquote>

No functions defined in this specification are required to provide a \misc{use-value} //[[CL:Glossary:restart]]//.

\issue{CONDITION-RESTARTS:PERMIT-ASSOCIATION} \issue{MUFFLE-WARNING-CONDITION-ARGUMENT} \issue{CONDITION-RESTARTS:PERMIT-ASSOCIATION} \issue{CONDITION-RESTARTS:PERMIT-ASSOCIATION}
